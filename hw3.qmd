---
title: "Homework Assignment 3: Connecticut Schools"
author: "Marcus Arles"
date: "`r Sys.Date()`"
format:
  html:
    toc: true
    toc-depth: 2
    embed-resources: true
    code-fold: true
    theme: cosmo
---

## Context

Data on schools from the Common Core of Data (CCD) are collected by the National Center for Education Statistics. Information about the CCD can be found here. We are working with a subset of the 2013-14 dataset, data/ct_schools in the classnotes repo. A variable codebook for the CCD, which will explain what each column represents in the data file is located in the flat file in the record layout column and 2013-14 row.


## Problem 1: 

Load the appropriate packages and load the data.

### Answer:

+ library(tidyverse)
+ ct_schools <- read.csv(“ct_schools.csv”)
+ head(ct_schools)

```{r}
library(tidyverse)
ct_schools <- read.csv("ct_schools.csv")
head(ct_schools)
```

## Problem 2: Data manipulation


a. Make a new variable sch_type that has the value Charter, Magnet or TPS, to specify if the school is a charter, magnet or traditional public school.

b. How many schools of each of these three types are in our area?

c. Make a table that show the number of schools of each of the three school types that are missing data for free lunch.

### Answer:

a. 

ct_schools2 <- ct_schools %>%
  mutate(
     sch_type = case_when(
       MAGNET == 1 ~ "Magnet",
       CHARTR == 1 ~ "Charter",
       MAGNET == 2 & CHARTR == 2 ~ "TPS",
       TRUE ~ NA_character_ 
     )
  )

```{r}
ct_schools2 <- ct_schools %>%
  mutate(
    sch_type = case_when(
      MAGNET == 1 ~ "Magnet",
      CHARTR == 1 ~ "Charter",
      MAGNET == 2 & CHARTR == 2 ~ "TPS",
      TRUE ~ NA_character_ 
    )
  )
```

b. 

ct_schools2 %>%
  count(sch_type)

```{r}
ct_schools2 %>%
  count(sch_type)
```

c. 
ct_schools2 %>%
group_by(sch_type) %>%
  summarise(
    n = n(),
    n_missing_free_lunch = sum(is.na(FRELCH)),
    pct_missing = mean(is.na(FRELCH)) * 100
  )

```{r}
ct_schools2 %>%
group_by(sch_type) %>%
  summarise(
    n = n(),
    n_missing_free_lunch = sum(is.na(FRELCH)),
    pct_missing = mean(is.na(FRELCH)) * 100
  )
```

## Problem 3: Descriptives

a. How many schools are elementary schools? Middle schools? High schools? Other? Missing?

b. How many schools are eligible for Title I status? Summarize the count of schools in each category

### Answer:

a. 

ct_schools <- ct_schools |>
   mutate(level_group = case_when(
     LEVEL == 1 ~ "Elementary",
     LEVEL == 2 ~ "Middle",
     LEVEL == 3 ~ "High",
     is.na(LEVEL) ~ "Missing",
     TRUE ~ "Other"
   )
  )

```{r}
ct_schools <- ct_schools |>
   mutate(level_group = case_when(
     LEVEL == 1 ~ "Elementary",
     LEVEL == 2 ~ "Middle",
     LEVEL == 3 ~ "High",
     is.na(LEVEL) ~ "Missing",
     TRUE ~ "Other"
   )
  )

```

ct_schools |>
  count(level_group)

```{r}
ct_schools |>
  count(level_group)

```

b. 

ct_schools <- ct_schools |>
   mutate(title_i_status = case_when(
     TITLEI == 1 ~ "Eligible",
     TITLEI == 2 ~ "Not Eligible",
     is.na(TITLEI) ~ "Missing",
     TRUE ~ "Other"
   ))

```{r}
ct_schools <- ct_schools |>
   mutate(title_i_status = case_when(
     TITLEI == 1 ~ "Eligible",
     TITLEI == 2 ~ "Not Eligible",
     is.na(TITLEI) ~ "Missing",
     TRUE ~ "Other"
   ))

```

ct_schools |>
   count(title_i_status)

```{r}
ct_schools |>
  count(title_i_status)
```

## Problem 4: Racial composition

a. Create new variables that compute the percentage of students who are Black, White, Hispanic, Asian or another race (call this variable “other”), and the percentage of students receiving free OR reduced price lunch.

b. Visualize these data to see the variability of each of these variables (Hint: Use geom_histogram).

### Answer:

a:

ct_schools <- ct_schools |>
  mutate(
    pct_white = WHITE / TOTETH * 100,
    pct_black = BLACK / TOTETH * 100,
    pct_hispanic = HISP / TOTETH * 100,
    pct_asian = ASIAN / TOTETH * 100,
    pct_other = 100 - pct_white - pct_black - pct_hispanic - pct_asian,
    pct_frpl = (FRELCH + REDLCH) / TOTETH * 100
  )

```{r}
ct_schools <- ct_schools |>
  mutate(
    pct_white = WHITE / TOTETH * 100,
    pct_black = BLACK / TOTETH * 100,
    pct_hispanic = HISP / TOTETH * 100,
    pct_asian = ASIAN / TOTETH * 100,
    pct_other = 100 - pct_white - pct_black - pct_hispanic - pct_asian,
    pct_frpl = (FRELCH + REDLCH) / TOTETH * 100
  )

```

b. 
ggplot(ct_schools, aes(x = pct_white)) +
   geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
   labs(
     title = "Distribution of % White Students Across Schools",
     x = "Percent White Students",
     y = "Number of Schools") +
       theme_minimal()

```{r}
ggplot(ct_schools, aes(x = pct_white)) +
   geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
   labs(
     title = "Distribution of % White Students Across Schools",
     x = "Percent White Students",
     y = "Number of Schools") +
       theme_minimal()

```

ggplot(ct_schools, aes(x = pct_black)) +
   geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
   labs(
     title = "Distribution of % Black Students Across Schools",
     x = "Percent Black Students",
     y = "Number of Schools") +
       theme_minimal()

```{r}
ggplot(ct_schools, aes(x = pct_black)) +
   geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
   labs(
     title = "Distribution of % Black Students Across Schools",
     x = "Percent Black Students",
     y = "Number of Schools") +
       theme_minimal()

```

ggplot(ct_schools, aes(x = pct_hispanic)) +
   geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
   labs(
     title = "Distribution of % Hispanic Students Across Schools",
     x = "Percent Hispanic Students",
     y = "Number of Schools") +
       theme_minimal()

```{r}
ggplot(ct_schools, aes(x = pct_hispanic)) +
   geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
   labs(
     title = "Distribution of % Hispanic Students Across Schools",
     x = "Percent Hispanic Students",
     y = "Number of Schools") +
       theme_minimal()

```

ggplot(ct_schools, aes(x = pct_asian)) +
   geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
   labs(
     title = "Distribution of % Asian Students Across Schools",
     x = "Percent Asian Students",
     y = "Number of Schools") +
       theme_minimal()

```{r}
ggplot(ct_schools, aes(x = pct_asian)) +
   geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
   labs(
     title = "Distribution of % Asian Students Across Schools",
     x = "Percent Asian Students",
     y = "Number of Schools") +
       theme_minimal()

```

ggplot(ct_schools, aes(x = pct_other)) +
   geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
   labs(
     title = "Distribution of % Other Students Across Schools",
     x = "Percent Other Students",
     y = "Number of Schools") +
       theme_minimal()

```{r}
ggplot(ct_schools, aes(x = pct_other)) +
   geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
   labs(
     title = "Distribution of % Other Students Across Schools",
     x = "Percent Other Students",
     y = "Number of Schools") +
       theme_minimal()

```

ggplot(ct_schools, aes(x = pct_frpl)) +
   geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
   labs(
     title = "Distribution of % Frpl Students Across Schools",
     x = "Percent Frpl Students",
     y = "Number of Schools") +
       theme_minimal()

```{r}
ggplot(ct_schools, aes(x = pct_frpl)) +
   geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
   labs(
     title = "Distribution of % Frpl Students Across Schools",
     x = "Percent Frpl Students",
     y = "Number of Schools") +
       theme_minimal()

```

## Problem 5: 

Visualize the variation in the percent of students receiving free lunch (frelch) for magnet schools, TPS, and charter schools (Hint: Use geom_boxplot).

### Answer:

## Problem 6: 

Visualize the variation in the percent of students of each race and ethnicity in the data file (Black, White, Hispanic, Asian and Other) for each of the type of schools (magnet, TPS and charter).

### Answer:

## Problem 7:

With more R skills what types of questions could you answer using this dataset?

### Answer:

## Problem 8:

What are some questions you have about this dataset? What information would you add to the dataset, if you could?

### Answer:







